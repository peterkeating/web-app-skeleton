<?xml version="1.0"?>
<!DOCTYPE project>
<project name="app-build" default="build" basedir="../">

    <!--
        Gives access to environment variables.
    -->
    <property environment="ENV" />

    <!--
        Loads the project specific configuration values.
    -->
    <property file="build/config/project.properties"/>

    <!--
        Load in Ant-Contrib to give us access to some very useful tasks!
        Learn more about Ant-Contrib and the extra functionality it offers from
        the link below.

        - http://ant-contrib.sourceforge.net/
    -->
    <taskdef resource="net/sf/antcontrib/antlib.xml">
        <classpath>
            <pathelement location="${tool.antcontrib}"/>
        </classpath>
    </taskdef>

    <!--
        Default target will build the project created artifacts that will be
        placed in the distribution directory.
    -->
    <target name="build" depends="-clean, -prepare, -copy, -package, -tidy" />

    <!--
        Removes any previous artifacts from previous build attempts.
    -->
    <target name="-clean">
        <delete dir="${dist.dir}" />
        <delete dir="${intermediate.dir}" />
    </target>

    <!--
        Create any directories needed during the build task.
    -->
    <target name="-prepare">
        <mkdir dir="${dist.dir}" />
        <mkdir dir="${intermediate.dir}" />
    </target>

    <!--
        Files are copied from the src directory into an intermediate directory.
        This ensures that the src files are not manipulated in a way that would
        cause them to change and potentially break the product.

        Also by copying the files into a middle man directory any changes made
        doesn't trigger a change that would be picked up by any version control
        solutions that might be running.

        The intermediate directory should be ignored by any version control solutions.
    -->
    <target name="-copy">
        <copy todir="${intermediate.dir}">
            <fileset dir="${app.dir}" />
        </copy>
    </target>

    <!--
        Takes the files that are done with being configured and optimised and places
        them in the distribution directory ready to be used wherever the application
        is being hosted.
    -->
    <target name="-package">
        <copy todir="${dist.dir}">
            <fileset dir="${intermediate.dir}" />
        </copy>
    </target>

    <!--
        There is no longer a requirement for the directory used to contain the src
        files during their manipulation so it can be deleted.
    -->
    <target name="-tidy">
        <delete dir="${intermediate.dir}" />
    </target>
</project>
